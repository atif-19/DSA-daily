// ‚úÖ Problem: Celebrity Problem
// GFG Problem Link: https://www.geeksforgeeks.org/problems/the-celebrity-problem/1
//
// üß© Problem Statement:
// You are given a square matrix `mat` of size N x N where:
//   - mat[i][j] = 1 ‚Üí person i knows person j
//   - mat[i][j] = 0 ‚Üí person i does NOT know person j
//
// A *celebrity* is a person who is:
//   1Ô∏è‚É£ Known by everyone else
//   2Ô∏è‚É£ Knows no one in return
//
// Your task: find the index of the celebrity if one exists, otherwise return -1.
//
// ----------------------------------------------------------
// üß† Approach (Stack Elimination Technique):
//
// Intuition: If A knows B ‚Üí A **cannot** be a celebrity.
//            If A does not know B ‚Üí B **cannot** be a celebrity.
//
// 1Ô∏è‚É£ Push all people (indices 0 to N-1) into a stack.
// 2Ô∏è‚É£ Pop two people at a time: `first` and `second`.
//     - If `first` knows `second`, `first` cannot be celebrity ‚Üí push `second` back.
//     - Else if `second` knows `first`, `second` cannot be celebrity ‚Üí push `first` back.
// 3Ô∏è‚É£ Continue until only one person remains ‚Üí that‚Äôs our *potential celebrity*.
// 4Ô∏è‚É£ Validate this person by checking:
//     - They know nobody: `mat[first][k] == 0` for all k != first
//     - Everyone knows them: `mat[k][first] == 1` for all k != first
// 5Ô∏è‚É£ If both conditions hold, return index `first`, else return -1.
//
// ----------------------------------------------------------
// ‚ú® Example:
//
// Input:
// mat = [[0, 1, 0],
//        [0, 0, 0],
//        [0, 1, 0]]
//
// Step 1: Push all ‚Üí stack = [2, 1, 0]
// Step 2: Compare (0, 1): 0 knows 1 ‚Üí pop 0 ‚Üí push 1
// Step 3: Compare (1, 2): 2 knows 1 ‚Üí pop 2 ‚Üí push 1
// Stack ‚Üí [1]
// Step 4: Verify 1 ‚Üí 
//          1 knows nobody ‚úÖ
//          everyone knows 1 ‚úÖ
// Output: 1 (Celebrity)
//
// ----------------------------------------------------------
// ‚è±Ô∏è Time Complexity: O(N)
// Each pair is compared once + O(N) verification.
// üíæ Space Complexity: O(N) for the stack.
//
// ----------------------------------------------------------

#include <bits/stdc++.h>
using namespace std;

class Solution {
  public:
    int celebrity(vector<vector<int>>& mat) {
        int n = mat.size();
        stack<int> st;

        // Step 1Ô∏è‚É£: Push all people into the stack
        for (int i = n - 1; i >= 0; i--)
            st.push(i);
        
        int first, second;

        // Step 2Ô∏è‚É£: Eliminate non-celebrities using pairwise comparison
        while (!st.empty()) {
            first = st.top();
            st.pop();
            if (st.empty()) break;
            second = st.top();
            st.pop();

            // Case 1: first knows second ‚Üí first cannot be celebrity
            if (mat[first][second] && !mat[second][first])
                st.push(second);

            // Case 2: second knows first ‚Üí second cannot be celebrity
            if (!mat[first][second] && mat[second][first])
                st.push(first);
        }

        // Step 3Ô∏è‚É£: Verify the potential celebrity
        for (int k = 0; k < n; k++) {
            if (first != k) {
                if (mat[first][k] || !mat[k][first])
                    return -1; // fails the celebrity condition
            }
        }

        // Step 4Ô∏è‚É£: Return the celebrity index
        return first;
    }
};
