/*
------------------------------------------------------------
ðŸ§  Problem: Remove Loop in a Linked List
------------------------------------------------------------
Given a linked list that may contain a loop (cycle),
the task is to remove the loop if present â€” without
losing any nodes of the list.

After removal, the linked list should become linear
(i.e., should not contain any cycle).

------------------------------------------------------------
ðŸ’¡ Approach: Floydâ€™s Cycle Detection Algorithm 
(Tortoise and Hare Method)
------------------------------------------------------------
1ï¸âƒ£ Use two pointers:
    - `slow` moves 1 step at a time.
    - `fast` moves 2 steps at a time.

2ï¸âƒ£ Detect loop:
    - Move both pointers until `slow == fast`.
    - If `fast` or `fast->next` becomes NULL â†’ no loop exists.

3ï¸âƒ£ Find the start of the loop:
    - Move `slow` to `head`.
    - Move both `slow` and `fast` one step at a time.
    - When they meet again â†’ thatâ€™s the start of the loop.

4ï¸âƒ£ Remove the loop:
    - Traverse until `slow->next == fast`.
    - Set `slow->next = NULL` to break the cycle.

------------------------------------------------------------
ðŸ“ˆ Example:
Input:
1 -> 2 -> 3 -> 4 -> 5
         â†‘         |
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Output (after removal):
1 -> 2 -> 3 -> 4 -> 5 -> NULL

------------------------------------------------------------
â±ï¸ Time Complexity: O(N)
ðŸ“¦ Space Complexity: O(1)
------------------------------------------------------------
*/

class Solution {
  public:
    void removeLoop(Node* head) {
        Node* slow = head, *fast = head;

        // Step 1: Detect loop using Floydâ€™s algorithm
        while (fast && fast->next) {
            slow = slow->next;
            fast = fast->next->next;
            if (slow == fast)
                break;
        }

        // Step 2: If no loop, return
        if (fast == NULL || fast->next == NULL)
            return;

        // Step 3: Find the start node of the loop
        slow = head;
        while (slow != fast) {
            slow = slow->next;
            fast = fast->next;
        }

        // Step 4: Remove the loop
        while (slow->next != fast)
            slow = slow->next;

        slow->next = NULL;
    }
};
