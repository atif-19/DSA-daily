/*
===========================================================
üìå Min Heap Implementation in C++
-----------------------------------------------------------
Author      : Atif
Description :
    This program demonstrates an array-based implementation
    of a Min Heap.

    Features:
    - Insert elements into Min Heap
    - Delete (remove) the minimum element (root)
    - Heapify to maintain heap property
    - Handles edge cases like:
        ‚Ä¢ Heap Overflow
        ‚Ä¢ Heap Underflow

    Note:
    Overflow and underflow conditions are intentionally
    tested in the main function to validate robustness.

    Heap Property:
    - Parent node is always smaller than or equal to
      its child nodes.

    Index Formulas:
    - Parent Index      = (i - 1) / 2
    - Left Child Index  = 2*i + 1
    - Right Child Index = 2*i + 2
===========================================================
*/

#include <iostream>
using namespace std;

/*
-----------------------------------------------------------
üì¶ MinHeap Class
-----------------------------------------------------------
Encapsulates all operations required for a Min Heap.
-----------------------------------------------------------
*/
class MinHeap {
public:
    int* arr;          // Dynamic array to store heap elements
    int size;          // Current number of elements in heap
    int total_size;    // Maximum capacity of heap

    /*
    -------------------------------------------------------
    üõ†Ô∏è Constructor
    -------------------------------------------------------
    Initializes heap with a fixed capacity.
    -------------------------------------------------------
    */
    MinHeap(int n) {
        arr = new int[n];
        size = 0;
        total_size = n;
    }

    /*
    -------------------------------------------------------
    ‚ûï Insert Operation
    -------------------------------------------------------
    Inserts a new element into the heap and restores
    the Min Heap property using upward heapification.
    -------------------------------------------------------
    */
    void insert(int value) {
        if (size == total_size) {
            cout << "Heap overflow" << endl;
            return;
        }

        // Insert element at the end
        int index = size;
        arr[index] = value;
        size++;

        // Bubble up to maintain Min Heap property
        while (index > 0 && arr[index] < arr[(index - 1) / 2]) {
            swap(arr[index], arr[(index - 1) / 2]);
            index = (index - 1) / 2;
        }

        cout << value << " is inserted into the heap" << endl;
    }

    /*
    -------------------------------------------------------
    üñ®Ô∏è Print Heap
    -------------------------------------------------------
    Prints heap elements in array form.
    -------------------------------------------------------
    */
    void print() {
        for (int i = 0; i < size; i++)
            cout << arr[i] << " ";
        cout << endl;
    }

    /*
    -------------------------------------------------------
    üîÅ Heapify Operation
    -------------------------------------------------------
    Restores Min Heap property for subtree rooted
    at the given index.
    -------------------------------------------------------
    */
    void Heapify(int index) {
        int smallest = index;
        int left = 2 * index + 1;
        int right = 2 * index + 2;

        if (left < size && arr[left] < arr[smallest])
            smallest = left;

        if (right < size && arr[right] < arr[smallest])
            smallest = right;

        if (smallest != index) {
            swap(arr[index], arr[smallest]);
            Heapify(smallest);
        }
    }

    /*
    -------------------------------------------------------
    ‚ùå Delete Operation
    -------------------------------------------------------
    Removes the minimum element (root) from the heap
    and restores the Min Heap property.
    -------------------------------------------------------
    */
    void Delete() {
        if (size == 0) {
            cout << "Heap underflow" << endl;
            return;
        }

        cout << arr[0] << " is removed from the heap" << endl;

        // Replace root with last element
        swap(arr[0], arr[size - 1]);
        size--;

        if (size > 0)
            Heapify(0);
    }
};

/*
-----------------------------------------------------------
üöÄ Main Function
-----------------------------------------------------------
Demonstrates Min Heap operations.

Includes intentional testing of:
- Heap Overflow (extra insert)
- Heap Underflow (extra delete)
-----------------------------------------------------------
*/
int main() {

    // Create Min Heap with capacity 5
    MinHeap h1(5);

    // Insert elements
    h1.insert(10);
    h1.insert(40);
    h1.insert(1);
    h1.insert(67);
    h1.insert(4);

    // Intentional overflow test
    h1.insert(10);

    h1.print();

    // Delete elements
    h1.Delete();
    h1.Delete();
    h1.Delete();
    h1.Delete();
    h1.Delete();

    // Intentional underflow test
    h1.Delete();

    return 0;
}
